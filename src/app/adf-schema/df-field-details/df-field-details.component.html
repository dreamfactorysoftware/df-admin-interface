<form
  [formGroup]="fieldDetailsForm"
  class="details-section"
  [class]="(isDarkMode | async) ? 'dark-theme' : ''"
  (ngSubmit)="onSubmit()">
  <div class="full-width">
    <mat-form-field
      appearance="outline"
      subscriptSizing="dynamic"
      class="dynamic-width">
      <mat-label>{{
        'schema.fieldDetailsForm.controls.name' | transloco
      }}</mat-label>
      <input matInput formControlName="name" />
      <mat-error
        *ngIf="this.fieldDetailsForm.controls['name'].hasError('required')">
        {{ 'schema.fieldDetailsForm.errors.name' | transloco }}
      </mat-error>
    </mat-form-field>
  </div>

  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.alias.label' | transloco
    }}</mat-label>
    <input matInput formControlName="alias" />
    <fa-icon
      class="tool-tip-trigger"
      matSuffix
      [icon]="faCircleInfo"
      [matTooltip]="
        'schema.fieldDetailsForm.controls.alias.tooltip' | transloco
      " />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.label.label' | transloco
    }}</mat-label>
    <input matInput formControlName="label" />
    <fa-icon
      class="tool-tip-trigger"
      matSuffix
      [icon]="faCircleInfo"
      [matTooltip]="
        'schema.fieldDetailsForm.controls.label.tooltip' | transloco
      " />
  </mat-form-field>

  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.type.label' | transloco
    }}</mat-label>
    <mat-select formControlName="type">
      <mat-option
        *ngFor="let option of typeDropdownMenuOptions"
        [value]="option">
        {{ option }}
      </mat-option>
    </mat-select>
    <fa-icon
      class="tool-tip-trigger"
      matSuffix
      [icon]="faCircleInfo"
      [matTooltip]="
        'schema.fieldDetailsForm.controls.type.tooltip' | transloco
      " />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.databaseType.label' | transloco
    }}</mat-label>
    <input matInput formControlName="dbType" />
    <fa-icon
      class="tool-tip-trigger"
      matSuffix
      [icon]="faCircleInfo"
      [matTooltip]="
        'schema.fieldDetailsForm.controls.databaseType.tooltip' | transloco
      " />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.length' | transloco
    }}</mat-label>
    <input type="number" matInput formControlName="length" />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.precision' | transloco
    }}</mat-label>
    <input type="number" matInput formControlName="precision" />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.scale' | transloco
    }}</mat-label>
    <input type="number" matInput formControlName="scale" />
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.defaultValue' | transloco
    }}</mat-label>
    <input matInput formControlName="default" />
  </mat-form-field>
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isVirtual"
    >{{
      'schema.fieldDetailsForm.controls.isVirtual' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isAggregate"
    >{{
      'schema.fieldDetailsForm.controls.isAggregate' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="fixedLength"
    >{{
      'schema.fieldDetailsForm.controls.fixedLength' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="supportsMultibyte"
    >{{
      'schema.fieldDetailsForm.controls.supportsMultibyte' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="allowNull"
    >{{
      'schema.fieldDetailsForm.controls.allowNull' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="autoIncrement"
    >{{
      'schema.fieldDetailsForm.controls.autoIncrement' | transloco
    }}</mat-slide-toggle
  >

  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isIndex"
    >{{
      'schema.fieldDetailsForm.controls.isIndex' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isUnique"
    >{{
      'schema.fieldDetailsForm.controls.isUnique' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isPrimaryKey"
    >{{
      'schema.fieldDetailsForm.controls.isPrimaryKey' | transloco
    }}</mat-slide-toggle
  >
  <mat-slide-toggle
    color="primary"
    class="dynamic-width"
    formControlName="isForeignKey"
    >{{
      'schema.fieldDetailsForm.controls.isForeignKey' | transloco
    }}</mat-slide-toggle
  >

  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.refTable' | transloco
    }}</mat-label>
    <mat-select formControlName="refTable">
      <mat-option
        *ngFor="let table of referenceTableDropdownMenuOptions"
        [value]="table.name">
        {{ table.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="dynamic-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.refField' | transloco
    }}</mat-label>
    <mat-select formControlName="refField">
      <mat-option
        *ngFor="let field of referenceFieldDropdownMenuOptions"
        [value]="field.name"
        >{{ field.label }}</mat-option
      >
    </mat-select>
  </mat-form-field>
  <mat-form-field
    appearance="outline"
    subscriptSizing="dynamic"
    class="full-width">
    <mat-label>{{
      'schema.fieldDetailsForm.controls.validation.label' | transloco
    }}</mat-label>
    <textarea
      matInput
      rows="4"
      cols="6"
      formControlName="validation"></textarea>
    <fa-icon
      class="tool-tip-trigger"
      matSuffix
      [icon]="faCircleInfo"
      [matTooltip]="
        'schema.fieldDetailsForm.controls.validation.tooltip' | transloco
      " />
    <mat-error
      *ngIf="
        this.fieldDetailsForm.controls['validation'].hasError('jsonInvalid')
      ">
      {{ 'schema.fieldDetailsForm.errors.json' | transloco }}
    </mat-error>
  </mat-form-field>
  <df-function-use
    formArrayName="dbFunction"
    class="full-width"></df-function-use>
  <ng-container *ngIf="this.fieldDetailsForm.controls['picklist']"
    ><mat-form-field
      appearance="outline"
      subscriptSizing="dynamic"
      class="dynamic-width">
      <mat-label>{{
        'schema.fieldDetailsForm.controls.picklist' | transloco
      }}</mat-label>
      <input matInput formControlName="picklist" />
    </mat-form-field>
    <mat-error
      *ngIf="this.fieldDetailsForm.controls['picklist'].hasError('csvInvalid')">
      {{ 'schema.fieldDetailsForm.errors.csv' | transloco }}
    </mat-error>
  </ng-container>
  <div class="full-width action-bar">
    <button
      class="cancel-btn"
      type="button"
      mat-flat-button
      (click)="onCancel()">
      Cancel
    </button>
    <button class="save-btn" mat-flat-button>
      {{ (databaseFieldToEdit ? 'save' : 'create') | transloco }}
    </button>
  </div>
</form>

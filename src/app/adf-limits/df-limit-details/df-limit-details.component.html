<df-alert
  [showAlert]="showAlert"
  [alertType]="alertType"
  (alertClosed)="showAlert = false"
  >{{ alertMsg }}</df-alert
>
<form [formGroup]="formGroup" class="details-section" (ngSubmit)="onSubmit()">
  <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
    <mat-label>{{ 'limits.name' | transloco }}</mat-label>
    <input matInput type="text" formControlName="limitName" />
  </mat-form-field>
  <df-verb-picker
    class="dynamic-width"
    formControlName="verb"
    [schema]="{
      label: 'limits.verb' | transloco,
      description: 'limits.verbTooltip' | transloco
    }"></df-verb-picker>
  <mat-form-field subscriptSizing="dynamic" class="full-width">
    <mat-label>{{ 'limits.description' | transloco }}</mat-label>
    <textarea
      rows="1"
      matInput
      type="text"
      formControlName="description"></textarea>
  </mat-form-field>
  <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
    <mat-label>{{ 'limits.limitType' | transloco }}</mat-label>
    <mat-select formControlName="limitType">
      <mat-option value="instance"
        >{{ 'limits.limitTypes.instance' | transloco }}
      </mat-option>
      <mat-option value="instance.user"
        >{{ 'limits.limitTypes.user' | transloco }}
      </mat-option>
      <mat-option value="instance.each_user"
        >{{ 'limits.limitTypes.eachUser' | transloco }}
      </mat-option>
      <mat-option value="instance.service"
        >{{ 'limits.limitTypes.service' | transloco }}
      </mat-option>
      <mat-option value="instance.role"
        >{{ 'limits.limitTypes.role' | transloco }}
      </mat-option>
      <mat-option value="instance.user.service"
        >{{ 'limits.limitTypes.serviceByUser' | transloco }}
      </mat-option>
      <mat-option value="instance.each_user.service"
        >{{ 'limits.limitTypes.serviceByEachUser' | transloco }}
      </mat-option>
      <mat-option value="instance.service.endpoint"
        >{{ 'limits.limitTypes.endpoint' | transloco }}
      </mat-option>
      <mat-option value="instance.user.service.endpoint"
        >{{ 'limits.limitTypes.endpointByUser' | transloco }}
      </mat-option>
      <mat-option value="instance.each_user.service.endpoint"
        >{{ 'limits.limitTypes.endpointByEachUser' | transloco }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <ng-container *ngIf="this.formGroup.controls['serviceId']">
    <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
      <mat-label>{{ 'limits.service' | transloco }}</mat-label>
      <mat-select formControlName="serviceId">
        <mat-option
          *ngFor="let service of serviceDropdownOptions"
          [value]="service.id"
          >{{ service.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>
  <ng-container *ngIf="this.formGroup.controls['roleId']">
    <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
      <mat-label>{{ 'limits.role' | transloco }}</mat-label>
      <mat-select formControlName="roleId">
        <mat-option *ngFor="let role of roleDropdownOptions" [value]="role.id"
          >{{ role.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>
  <ng-container *ngIf="this.formGroup.controls['userId']">
    <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
      <mat-label>{{ 'limits.user' | transloco }}</mat-label>
      <mat-select formControlName="userId">
        <mat-option *ngFor="let user of userDropdownOptions" [value]="user.id"
          >{{ user.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>
  <ng-container *ngIf="this.formGroup.controls['endpoint']">
    <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
      <mat-label>{{ 'limits.endpoint' | transloco }}</mat-label>
      <input matInput type="text" formControlName="endpoint" />
    </mat-form-field>
  </ng-container>
  <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
    <mat-label>{{ 'limits.limitRate' | transloco }}</mat-label>
    <input matInput type="number" formControlName="limitRate" />
  </mat-form-field>
  <mat-form-field subscriptSizing="dynamic" class="dynamic-width">
    <mat-label>{{ 'limits.limitPeriod' | transloco }}</mat-label>
    <mat-select formControlName="limitPeriod">
      <mat-option value="minute"
        >{{ 'limits.limitPeriods.minute' | transloco }}
      </mat-option>
      <mat-option value="hour"
        >{{ 'limits.limitPeriods.hour' | transloco }}
      </mat-option>
      <mat-option value="day"
        >{{ 'limits.limitPeriods.day' | transloco }}
      </mat-option>
      <mat-option value="7-day"
        >{{ 'limits.limitPeriods.week' | transloco }}
      </mat-option>
      <mat-option value="30-day"
        >{{ 'limits.limitPeriods.30Days' | transloco }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <ng-container>
    <mat-slide-toggle class="full-width" formControlName="active">{{
      'limits.active' | transloco
    }}</mat-slide-toggle>
  </ng-container>
  <div class="full-width action-bar">
    <button type="button" mat-flat-button (click)="onCancel()">
      {{ 'cancel' | transloco }}
    </button>
    <button mat-flat-button color="primary">
      {{ 'save' | transloco }}
    </button>
  </div>
</form>

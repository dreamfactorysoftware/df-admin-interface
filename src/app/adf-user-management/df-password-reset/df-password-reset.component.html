<mat-card class="user-management-card">
  <df-alert
    [message]="alertMsg"
    [showAlert]="showAlert"
    [alertType]="alertType"
    (alertClosed)="showAlert = false"></df-alert>
  <mat-card-header>
    <mat-card-title>
      {{ 'userManagement.resetPassword' | translate }}
    </mat-card-title>
  </mat-card-header>
  <mat-divider></mat-divider>
  <mat-card-content>
    <form
      name="reset-password-form"
      [formGroup]="passwordResetForm"
      (ngSubmit)="resetPassword()">
      <mat-form-field appearance="fill" *ngIf="loginAttribute === 'email'">
        <mat-label>
          {{ 'userManagement.controls.email.label' | translate }}</mat-label
        >
        <input
          matInput
          type="email"
          id="df-password-reset-email"
          name="df-password-reset-email"
          formControlName="email" />
        <mat-error
          *ngIf="
            passwordResetForm.get('email')?.errors?.['email'] &&
            !passwordResetForm.get('email')?.errors?.['required']
          ">
          {{ 'userManagement.controls.email.errors.invalid' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            !passwordResetForm.get('email')?.errors?.['email'] &&
            passwordResetForm.get('email')?.errors?.['required']
          ">
          {{ 'userManagement.controls.email.errors.required' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" *ngIf="loginAttribute === 'username'">
        <mat-label>{{
          'userManagement.controls.username.altLabel' | translate
        }}</mat-label>
        <input
          matInput
          type="text"
          id="df-passsword-reset-username"
          name="df-passsword-reset-username"
          formControlName="username" />
        <mat-error
          *ngIf="passwordResetForm.get('username')?.errors?.['required']">
          {{ 'userManagement.controls.username.errors.required' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>
          {{
            'userManagement.controls.confirmationCode.label' | translate
          }}</mat-label
        >
        <input
          matInput
          type="text"
          id="df-passsword-reset-code"
          name="df-passsword-reset-code"
          formControlName="code" />
        <mat-error *ngIf="passwordResetForm.get('code')?.errors?.['required']">
          {{
            'userManagement.controls.confirmationCode.errors.required'
              | translate
          }}
        </mat-error>
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>{{
          'userManagement.controls.password.label' | translate
        }}</mat-label>
        <input
          matInput
          type="password"
          id="df-password-reset-password"
          name="df-password-reset-password"
          formControlName="newPassword" />
        <mat-error
          *ngIf="passwordResetForm.get('newPassword')?.errors?.['required']">
          {{ 'userManagement.controls.password.errors.required' | translate }}
        </mat-error>
        <mat-error
          *ngIf="passwordResetForm.get('newPassword')?.errors?.['minlength']">
          {{ 'userManagement.controls.password.errors.length' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>{{
          'userManagement.controls.confirmPassword.label' | translate
        }}</mat-label>

        <input
          matInput
          type="password"
          id="df-password-reset-verify-password"
          name="df-password-reset-verify-password"
          formControlName="confirmPassword" />
        <mat-error
          *ngIf="
            passwordResetForm.get('confirmPassword')?.hasError('doesNotMatch')
          ">
          {{ 'userManagement.confirmPassword.errors.match' | translate }}
        </mat-error>
      </mat-form-field>
      <button
        mat-button
        color="primary"
        type="submit"
        id="submit-password-reset">
        {{ 'userManagement.resetPassword' | translate }}
      </button>
    </form>
  </mat-card-content>
</mat-card>

<div
  class="api-doc-button-container"
  [class]="(isDarkMode | async) ? 'dark-theme' : ''">
  <button class="cancel-btn" mat-raised-button (click)="goBackToList()">
    {{ 'goBack' | transloco }}
  </button>

  <button class="save-btn" mat-raised-button (click)="downloadApiDoc()">
    {{ 'apiDocs.downloadApiDoc' | transloco }}
  </button>
</div>

<!-- Moved API Keys Dropdown -->
<div class="api-keys-container" *ngIf="apiKeys.length">
  <mat-form-field appearance="outline" class="api-keys-select">
    <mat-label>{{ 'apiDocs.apiKeys.label' | transloco }}</mat-label>
    <mat-select>
      <mat-option *ngFor="let key of apiKeys" [value]="key.apiKey">
        <div class="api-key-option">
          <div class="key-info">
            <span class="key-name">{{ key.name }}</span>
            <span class="key-preview">{{ key.apiKey | slice: 0 : 8 }}...</span>
          </div>
          <button
            mat-icon-button
            (click)="$event.stopPropagation(); copyApiKey(key.apiKey)">
            <fa-icon [icon]="faCopy"></fa-icon>
          </button>
        </div>
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div #swaggerInjectedContentContainer class="custom-swagger-content-wrapper">
  <div
    #healthBannerElement
    class="api-health-banner"
    *ngIf="healthStatus"
    [ngClass]="{
      'status-loading': healthStatus === 'loading',
      'status-healthy': healthStatus === 'healthy',
      'status-unhealthy': healthStatus === 'unhealthy',
      'status-warning': healthStatus === 'warning'
    }">
    <div *ngIf="healthStatus === 'loading'">
      <p>{{ 'apiHealthBanner.loading' | transloco }}</p>
    </div>
    <div *ngIf="healthStatus === 'healthy'">
      <p>{{ 'apiHealthBanner.healthy' | transloco }}</p>
    </div>
    <div *ngIf="healthStatus === 'unhealthy'">
      <p>
        {{ 'apiHealthBanner.unhealthyBase' | transloco }}
        <button
          mat-button
          color="accent"
          class="view-details-button"
          (click)="toggleUnhealthyErrorDetails()">
          {{
            (showUnhealthyErrorDetails
              ? 'apiHealthBanner.hideDetails'
              : 'apiHealthBanner.viewDetails'
            ) | transloco
          }}
        </button>
      </p>
      <div *ngIf="showUnhealthyErrorDetails" class="unhealthy-error-details">
        <pre>{{ healthError }}</pre>
      </div>
    </div>
    <div *ngIf="healthStatus === 'warning'">
      <p>
        {{ 'apiHealthBanner.warningDefault' | transloco }}
      </p>
    </div>
  </div>

  <mat-accordion *ngIf="curlCommands.length > 0">
    <mat-expansion-panel #curlCommandsPanel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          {{ 'apiBasicCurlCommands.title' | transloco }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div
          *ngIf="curlCommands && curlCommands.length > 0"
          class="curl-commands-container">
          <mat-card
            *ngFor="let command of curlCommands; let i = index"
            appearance="outlined">
            <mat-card-content>
              <pre class="curl-command-text">{{ command.text }}</pre>
            </mat-card-content>
            <mat-card-actions align="end" class="actions-container">
              <button
                mat-icon-button
                (click)="
                  $event.stopPropagation(); copyCurlCommand(command.text)
                "
                matTooltip="{{
                  'apiBasicCurlCommands.copyTooltip' | transloco
                }}">
                <fa-icon size="xs" [icon]="faCopy"></fa-icon>
              </button>
            </mat-card-actions>
          </mat-card>
        </div>
      </ng-template>
    </mat-expansion-panel>
  </mat-accordion>
</div>

<div #apiDocumentation class="swagger-ui"></div>

"use strict";(self.webpackChunkdf_admin_interface=self.webpackChunkdf_admin_interface||[]).push([[7653],{27653:($,f,r)=>{r.r(f),r.d(f,{DfAdminDetailsComponent:()=>d});var i,P=r(97582),l=r(56223),m=r(81896),g=r(26306),A=r(58504),O=r(54475),M=r(73998),C=r(86806),Z=r(84870),y=r(31033),D=r(2032),c=r(64170),v=r(75986),h=r(45597),T=r(32296),p=r(87466),u=r(96814),E=r(82599),U=r(2593),I=r(41089),x=r(42346),L=r(78791),e=r(65879),b=r(75911),B=r(49787),R=r(34909);function N(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"df-alert",14),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"mat-radio-group",15),e.ALo(5,"transloco"),e.TgZ(6,"mat-radio-button",16),e._uU(7),e.ALo(8,"transloco"),e.qZA(),e.TgZ(9,"mat-radio-button",17),e._uU(10),e.ALo(11,"transloco"),e.qZA()(),e.BQk()),2&n){const t=e.oxw();let o;e.xp6(1),e.Q6J("alertType",null!=(o=t.userForm.get("pass-invite"))&&o.touched&&null!=(o=t.userForm.get("pass-invite"))&&o.invalid?"error":"info")("showAlert",!0)("dismissible",!1),e.xp6(1),e.hij(" ",e.lcZ(3,7,t.userType+".alerts.new")," "),e.xp6(2),e.uIk("aria-label",e.lcZ(5,9,"selectAnOption")),e.xp6(3),e.Oqu(e.lcZ(8,11,"userManagement.controls.sendInvite.label")),e.xp6(3),e.Oqu(e.lcZ(11,13,"userManagement.controls.setPassword.label"))}}function K(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.sendInvite())}),e._uU(1),e.ALo(2,"transloco"),e._UZ(3,"fa-icon",20),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.lcZ(2,2,"sendInvite")," "),e.xp6(2),e.Q6J("icon",t.faEnvelope)}}function w(n,s){1&n&&(e.ynx(0),e.TgZ(1,"mat-checkbox",21),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.BQk()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,1,"userManagement.controls.setPassword.label")," "))}function W(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"transloco"),e.qZA(),e.YNc(3,K,4,4,"button",18),e.YNc(4,w,4,3,"ng-container",8)),2&n){const t=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,4,"confirmed"),": ",t.currentProfile.confirmed?"Yes":"No",""),e.xp6(2),e.Q6J("ngIf",!t.currentProfile.confirmed),e.xp6(1),e.Q6J("ngIf",t.userForm.contains("setPassword"))}}function F(n,s){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"userManagement.controls.password.errors.required")," "))}function J(n,s){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"userManagement.controls.password.errors.length")," "))}function Q(n,s){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"userManagement.controls.confirmPassword.errors.match")," "))}function Y(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",22)(2,"mat-label"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e._UZ(5,"input",23),e.YNc(6,F,3,3,"mat-error",8),e.YNc(7,J,3,3,"mat-error",8),e.qZA(),e.TgZ(8,"mat-form-field",22)(9,"mat-label"),e._uU(10),e.ALo(11,"transloco"),e.qZA(),e._UZ(12,"input",24),e.YNc(13,Q,3,3,"mat-error",8),e.qZA(),e.BQk()),2&n){const t=e.oxw();let o,a,_;e.xp6(3),e.Oqu(e.lcZ(4,5,"userManagement.controls.password.label")),e.xp6(3),e.Q6J("ngIf",null==(o=t.userForm.get("password"))||null==o.errors?null:o.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=t.userForm.get("password"))||null==a.errors?null:a.errors.minlength),e.xp6(3),e.Oqu(e.lcZ(11,7,"userManagement.controls.confirmPassword.label")),e.xp6(3),e.Q6J("ngIf",null==(_=t.userForm.get("confirmPassword"))?null:_.hasError("doesNotMatch"))}}function S(n,s){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"transloco"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.userType+".alerts.autoRole"))}}r(6625);const j=function(n){return{roleId:n}};function k(n,s){if(1&n&&(e._uU(0),e.ALo(1,"transloco")),2&n){const t=e.oxw(2);e.Oqu(e.xi3(1,1,t.userType+".alerts.roleId",e.VKq(4,j,t.currentProfile.userToAppToRoleByUserId[0].roleId)))}}function G(n,s){if(1&n&&(e.ynx(0,30),e.TgZ(1,"mat-checkbox",31),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.BQk()),2&n){const t=s.$implicit;e.Q6J("formGroupName",s.index),e.xp6(2),e.hij(" ",e.lcZ(3,2,"admins.tabs."+t.value.title),"")}}function q(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"h3"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"df-alert",25),e._uU(6),e.ALo(7,"transloco"),e.YNc(8,S,3,3,"ng-container",6),e.YNc(9,k,2,6,"ng-template",null,26,e.W1O),e.qZA(),e.TgZ(11,"mat-checkbox",27),e.NdJ("change",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.selectAllTabs(a))}),e._uU(12),e.ALo(13,"transloco"),e.qZA(),e.TgZ(14,"div",28),e.YNc(15,G,4,4,"ng-container",29),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(10),o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,9,o.userType+".accessByTabs")),e.xp6(2),e.Q6J("showAlert",!o.allTabsSelected)("dismissible",!1),e.xp6(1),e.hij(" ",e.lcZ(7,11,o.userType+".alerts.restrictedAdmin")," "),e.xp6(2),e.Q6J("ngIf","create"===o.type||0===o.currentProfile.userToAppToRoleByUserId.length)("ngIfElse",t),e.xp6(3),e.Q6J("checked",o.allTabsSelected),e.xp6(1),e.hij(" ",e.lcZ(13,13,"selectAll"),""),e.xp6(3),e.Q6J("ngForOf",o.tabs.controls)}}function H(n,s){if(1&n&&e._UZ(0,"df-user-app-roles",32),2&n){const t=e.oxw();e.Q6J("apps",t.apps)("roles",t.roles)}}let d=((i=class extends M.x{constructor(s,t,o,a,_,V,z,X){super(s,t,o,a,X),this.translateService=_,this.adminService=V,this.router=z,this.userType="admins"}sendInvite(){this.adminService.patch(this.currentProfile.id,null,{snackbarSuccess:"inviteSent"}).subscribe()}save(){if(this.userForm.invalid||this.userForm.pristine)return;const s={...this.userForm.value.profileDetailsGroup,isActive:this.userForm.value.isActive,accessByTabs:this.tabs?this.tabs.controls.filter(t=>t.value.checked).map(t=>t.value.name):[],isRestrictedAdmin:!!this.tabs&&this.tabs.controls.some(t=>!t.value.checked),lookupByUserId:this.userForm.getRawValue().lookupKeys};if("create"===this.type){const t="invite"===this.userForm.value["pass-invite"];t||(s.password=this.userForm.value.password),this.adminService.create({resource:[s]},{snackbarSuccess:"admins.alerts.createdSuccess",additionalParams:[{key:"send_invite",value:t}]}).pipe((0,g.K)(o=>(this.triggerAlert("error",this.translateService.translate((0,O.n)(o.error.error.context.resource[0].message))),(0,A._)(()=>new Error(o))))).subscribe(o=>{this.router.navigate(["../",o.resource[0].id],{relativeTo:this.activatedRoute})})}else this.userForm.value.setPassword&&(s.password=this.userForm.value.password),this.adminService.update(this.currentProfile.id,s,{snackbarSuccess:"admins.alerts.updateSuccess"}).pipe((0,g.K)(t=>(this.triggerAlert("error",t.error.error.message),(0,A._)(()=>new Error(t))))).subscribe(t=>{this.router.navigate(["../",t.id],{relativeTo:this.activatedRoute})})}}).\u0275fac=function(s){return new(s||i)(e.Y36(l.qu),e.Y36(m.gz),e.Y36(b.s),e.Y36(B.y),e.Y36(x.Vn),e.Y36(C.Hk),e.Y36(m.F0),e.Y36(R._))},i.\u0275cmp=e.Xpm({type:i,selectors:[["df-admin-details"]],standalone:!0,features:[e.qOj,e.jDz],decls:24,vars:23,consts:[[3,"showAlert","alertType","alertClosed"],["name","admin-form",3,"formGroup","ngSubmit"],[1,"user-details"],["formGroupName","profileDetailsGroup"],[1,"additional-info"],["formControlName","isActive"],[4,"ngIf","ngIfElse"],["editMode",""],[4,"ngIf"],["formArrayName","appRoles",3,"apps","roles",4,"ngIf"],["formArrayName","lookupKeys"],[1,"full-width","action-bar"],["mat-flat-button","","type","button",3,"routerLink"],["mat-flat-button","","color","primary","type","submit"],[3,"alertType","showAlert","dismissible"],["formControlName","pass-invite",1,"pass-invite"],["value","invite",1,"userform-invite-radio-btn"],["value","password",1,"userform-password-radio-btn"],["mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",3,"click"],[3,"icon"],["formControlName","setPassword"],["appearance","fill"],["matInput","","type","password","formControlName","password",1,"user-details-set-password"],["matInput","","type","password","formControlName","confirmPassword",1,"user-details-confirm-password"],["alertType","warning",3,"showAlert","dismissible"],["hasRole",""],[3,"checked","change"],["formArrayName","tabs",1,"access-tabs"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["formControlName","checked"],["formArrayName","appRoles",3,"apps","roles"]],template:function(s,t){if(1&s&&(e.TgZ(0,"df-alert",0),e.NdJ("alertClosed",function(){return t.showAlert=!1}),e._uU(1),e.qZA(),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return t.save()}),e.TgZ(3,"div",2),e.ALo(4,"async"),e._UZ(5,"df-profile-details",3),e.TgZ(6,"div",4)(7,"mat-slide-toggle",5),e._uU(8),e.ALo(9,"transloco"),e.qZA(),e.YNc(10,N,12,15,"ng-container",6),e.YNc(11,W,5,6,"ng-template",null,7,e.W1O),e.YNc(13,Y,14,9,"ng-container",8),e.YNc(14,q,16,15,"ng-container",8),e.qZA()(),e.YNc(15,H,1,2,"df-user-app-roles",9),e._UZ(16,"df-lookup-keys",10),e.TgZ(17,"div",11)(18,"button",12),e._uU(19),e.ALo(20,"transloco"),e.qZA(),e.TgZ(21,"button",13),e._uU(22),e.ALo(23,"transloco"),e.qZA()()()),2&s){const o=e.MAs(12);let a;e.Q6J("showAlert",t.showAlert)("alertType",t.alertType),e.xp6(1),e.hij(" ",t.alertMsg,"\n"),e.xp6(1),e.Q6J("formGroup",t.userForm),e.xp6(1),e.ekj("small",e.lcZ(4,15,t.isSmallScreen)),e.xp6(5),e.Oqu(e.lcZ(9,17,"active")),e.xp6(2),e.Q6J("ngIf","create"===t.type)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf","password"===(null==(a=t.userForm.get("pass-invite"))?null:a.value)||(null==(a=t.userForm.get("setPassword"))?null:a.value)),e.xp6(1),e.Q6J("ngIf",t.accessByTabs.length>0&&"admins"===t.userType&&("create"===t.type||"edit"===t.type&&!t.currentProfile.isRootAdmin)),e.xp6(1),e.Q6J("ngIf","users"===t.userType),e.xp6(3),e.Q6J("routerLink",t.cancelRoute),e.xp6(1),e.hij(" ",e.lcZ(20,19,"cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(23,21,"create"===t.type?"create":"update")," ")}},dependencies:[I.v,l.UX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,U.e,E.rP,E.Rr,u.O5,p.Fk,p.VQ,p.U0,T.ot,T.lW,h.uH,h.BN,v.p9,v.oG,c.lN,c.KE,c.hX,c.TO,D.c,D.Nt,u.ax,y.U,Z.a,m.rH,u.Ov,x.Ot],styles:[".user-details[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:32px}.user-details.small[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.user-details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1}.user-details[_ngcontent-%COMP%]   .additional-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.user-details[_ngcontent-%COMP%]   .additional-info[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.user-details[_ngcontent-%COMP%]   .access-tabs[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;max-height:240px}"]}),i);d=(0,P.gn)([(0,L.c)({checkProperties:!0})],d)}}]);
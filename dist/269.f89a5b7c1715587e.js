"use strict";(self.webpackChunkdf_admin_interface=self.webpackChunkdf_admin_interface||[]).push([[269],{70269:(q,f,s)=>{s.r(f),s.d(f,{DfAdminDetailsComponent:()=>p});var R=s(31635),i=s(89417),c=s(18498),E=s(99437),g=s(18810),P=s(53012),b=s(76765),A=s(24784),C=s(58751),O=s(30877),D=s(99631),_=s(32102),M=s(82765),I=s(20060),T=s(88834),m=s(5951),d=s(60177),v=s(30450),F=s(77493),y=s(51425),h=s(33609),$=s(49894),e=s(17705),G=s(82298),U=s(52608),B=s(95351);function k(r,o){if(1&r&&(e.qex(0),e.j41(1,"df-alert",14),e.EFF(2),e.nI1(3,"transloco"),e.k0s(),e.j41(4,"mat-radio-group",15),e.nI1(5,"transloco"),e.j41(6,"mat-radio-button",16),e.EFF(7),e.nI1(8,"transloco"),e.k0s(),e.j41(9,"mat-radio-button",17),e.EFF(10),e.nI1(11,"transloco"),e.k0s()(),e.bVm()),2&r){const t=e.XpG();let n;e.R7$(1),e.Y8G("alertType",null!=(n=t.userForm.get("pass-invite"))&&n.touched&&null!=(n=t.userForm.get("pass-invite"))&&n.invalid?"error":"info")("showAlert",!0)("dismissible",!1),e.R7$(1),e.SpI(" ",e.bMT(3,7,t.userType+".alerts.new")," "),e.R7$(2),e.BMQ("aria-label",e.bMT(5,9,"selectAnOption")),e.R7$(3),e.JRh(e.bMT(8,11,"userManagement.controls.sendInvite.label")),e.R7$(3),e.JRh(e.bMT(11,13,"userManagement.controls.setPassword.label"))}}function S(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.sendInvite())}),e.EFF(1),e.nI1(2,"transloco"),e.nrm(3,"fa-icon",20),e.k0s()}if(2&r){const t=e.XpG(2);e.R7$(1),e.SpI(" ",e.bMT(2,2,"sendInvite")," "),e.R7$(2),e.Y8G("icon",t.faEnvelope)}}function x(r,o){1&r&&(e.qex(0),e.j41(1,"mat-checkbox",21),e.EFF(2),e.nI1(3,"transloco"),e.k0s(),e.bVm()),2&r&&(e.R7$(2),e.SpI("",e.bMT(3,1,"userManagement.controls.setPassword.label")," "))}function N(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"transloco"),e.k0s(),e.DNE(3,S,4,4,"button",18),e.DNE(4,x,4,3,"ng-container",8)),2&r){const t=e.XpG();e.R7$(1),e.Lme("",e.bMT(2,4,"confirmed"),": ",t.currentProfile.confirmed?"Yes":"No",""),e.R7$(2),e.Y8G("ngIf",!t.currentProfile.confirmed),e.R7$(1),e.Y8G("ngIf",t.userForm.contains("setPassword"))}}function j(r,o){1&r&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"transloco"),e.k0s()),2&r&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"userManagement.controls.password.errors.required")," "))}function W(r,o){1&r&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"transloco"),e.k0s()),2&r&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"userManagement.controls.password.errors.length")," "))}function L(r,o){1&r&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"transloco"),e.k0s()),2&r&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"userManagement.controls.confirmPassword.errors.match")," "))}function K(r,o){if(1&r&&(e.qex(0),e.j41(1,"mat-form-field",22)(2,"mat-label"),e.EFF(3),e.nI1(4,"transloco"),e.k0s(),e.nrm(5,"input",23),e.DNE(6,j,3,3,"mat-error",8),e.DNE(7,W,3,3,"mat-error",8),e.k0s(),e.j41(8,"mat-form-field",22)(9,"mat-label"),e.EFF(10),e.nI1(11,"transloco"),e.k0s(),e.nrm(12,"input",24),e.DNE(13,L,3,3,"mat-error",8),e.k0s(),e.bVm()),2&r){const t=e.XpG();let n,a,l;e.R7$(3),e.JRh(e.bMT(4,5,"userManagement.controls.password.label")),e.R7$(3),e.Y8G("ngIf",null==(n=t.userForm.get("password"))||null==n.errors?null:n.errors.required),e.R7$(1),e.Y8G("ngIf",null==(a=t.userForm.get("password"))||null==a.errors?null:a.errors.minlength),e.R7$(3),e.JRh(e.bMT(11,7,"userManagement.controls.confirmPassword.label")),e.R7$(3),e.Y8G("ngIf",null==(l=t.userForm.get("confirmPassword"))?null:l.hasError("doesNotMatch"))}}function w(r,o){if(1&r&&(e.qex(0),e.EFF(1),e.nI1(2,"transloco"),e.bVm()),2&r){const t=e.XpG(2);e.R7$(1),e.JRh(e.bMT(2,1,t.userType+".alerts.autoRole"))}}s(36225);const Y=function(r){return{roleId:r}};function X(r,o){if(1&r&&(e.EFF(0),e.nI1(1,"transloco")),2&r){const t=e.XpG(2);e.JRh(e.i5U(1,1,t.userType+".alerts.roleId",e.eq3(4,Y,t.currentProfile.userToAppToRoleByUserId[0].roleId)))}}function V(r,o){if(1&r&&(e.qex(0,30),e.j41(1,"mat-checkbox",31),e.EFF(2),e.nI1(3,"transloco"),e.k0s(),e.bVm()),2&r){const t=o.$implicit;e.Y8G("formGroupName",o.index),e.R7$(2),e.SpI(" ",e.bMT(3,2,"admins.tabs."+t.value.title),"")}}function J(r,o){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"div")(2,"h3"),e.EFF(3),e.nI1(4,"transloco"),e.k0s(),e.j41(5,"df-alert",25),e.EFF(6),e.nI1(7,"transloco"),e.DNE(8,w,3,3,"ng-container",6),e.DNE(9,X,2,6,"ng-template",null,26,e.C5r),e.k0s(),e.j41(11,"mat-checkbox",27),e.bIt("change",function(a){e.eBV(t);const l=e.XpG();return e.Njj(l.selectAllTabs(a))}),e.EFF(12),e.nI1(13,"transloco"),e.k0s(),e.j41(14,"div",28),e.DNE(15,V,4,4,"ng-container",29),e.k0s()(),e.bVm()}if(2&r){const t=e.sdS(10),n=e.XpG();e.R7$(3),e.JRh(e.bMT(4,9,n.userType+".accessByTabs")),e.R7$(2),e.Y8G("showAlert",!n.allTabsSelected)("dismissible",!1),e.R7$(1),e.SpI(" ",e.bMT(7,11,n.userType+".alerts.restrictedAdmin")," "),e.R7$(2),e.Y8G("ngIf","create"===n.type||0===n.currentProfile.userToAppToRoleByUserId.length)("ngIfElse",t),e.R7$(3),e.Y8G("checked",n.allTabsSelected),e.R7$(1),e.SpI(" ",e.bMT(13,13,"selectAll"),""),e.R7$(3),e.Y8G("ngForOf",n.tabs.controls)}}function H(r,o){if(1&r&&e.nrm(0,"df-user-app-roles",32),2&r){const t=e.XpG();e.Y8G("apps",t.apps)("roles",t.roles)}}let p=class u extends b.s{constructor(o,t,n,a,l,z,Q,Z){super(o,t,n,a,Z),this.translateService=l,this.adminService=z,this.router=Q,this.userType="admins"}sendInvite(){this.adminService.patch(this.currentProfile.id,null,{snackbarSuccess:"inviteSent"}).subscribe()}save(){if(this.userForm.invalid||this.userForm.pristine)return;const o={...this.userForm.value.profileDetailsGroup,isActive:this.userForm.value.isActive,accessByTabs:this.tabs?this.tabs.controls.filter(t=>t.value.checked).map(t=>t.value.name):[],isRestrictedAdmin:!!this.tabs&&this.tabs.controls.some(t=>!t.value.checked),lookupByUserId:this.userForm.getRawValue().lookupKeys};if("create"===this.type){const t="invite"===this.userForm.value["pass-invite"];t||(o.password=this.userForm.value.password),this.adminService.create({resource:[o]},{snackbarSuccess:"admins.alerts.createdSuccess",additionalParams:[{key:"send_invite",value:t}]}).pipe((0,E.W)(n=>(this.triggerAlert("error",this.translateService.translate((0,P.u)(n.error.error.context.resource[0].message))),(0,g.$)(()=>new Error(n))))).subscribe(n=>{this.router.navigate(["../",n.resource[0].id],{relativeTo:this.activatedRoute})})}else this.userForm.value.setPassword&&(o.password=this.userForm.value.password),this.adminService.update(this.currentProfile.id,{...o,password:this.userForm.value.password},{snackbarSuccess:"admins.alerts.updateSuccess"}).pipe((0,E.W)(t=>(this.triggerAlert("error",t.error.error.message),(0,g.$)(()=>new Error(t))))).subscribe(t=>{this.router.navigate(["../",t.id],{relativeTo:this.activatedRoute})})}static{this.\u0275fac=function(t){return new(t||u)(e.rXU(i.ok),e.rXU(c.nX),e.rXU(G.f),e.rXU(U.R),e.rXU(h.JO),e.rXU(A.ir),e.rXU(c.Ix),e.rXU(B.o))}}static{this.\u0275cmp=e.VBU({type:u,selectors:[["df-admin-details"]],standalone:!0,features:[e.Vt3,e.aNF],decls:25,vars:27,consts:[[3,"showAlert","alertType","alertClosed"],["name","admin-form",3,"formGroup","ngSubmit"],[1,"user-details"],["formGroupName","profileDetailsGroup"],[1,"additional-info"],["color","primary","formControlName","isActive"],[4,"ngIf","ngIfElse"],["editMode",""],[4,"ngIf"],["formArrayName","appRoles",3,"apps","roles",4,"ngIf"],["formArrayName","lookupKeys"],[1,"full-width","action-bar"],["mat-flat-button","","type","button",1,"cancel-btn",3,"routerLink"],["mat-flat-button","","color","primary","type","submit",1,"save-btn"],[3,"alertType","showAlert","dismissible"],["formControlName","pass-invite",1,"pass-invite"],["value","invite",1,"userform-invite-radio-btn"],["value","password",1,"userform-password-radio-btn"],["mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",3,"click"],[3,"icon"],["formControlName","setPassword"],["appearance","outline"],["matInput","","type","password","formControlName","password",1,"user-details-set-password"],["matInput","","type","password","formControlName","confirmPassword",1,"user-details-confirm-password"],["alertType","warning",3,"showAlert","dismissible"],["hasRole",""],[3,"checked","change"],["formArrayName","tabs",1,"access-tabs"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["formControlName","checked"],["formArrayName","appRoles",3,"apps","roles"]],template:function(t,n){if(1&t&&(e.j41(0,"df-alert",0),e.bIt("alertClosed",function(){return n.showAlert=!1}),e.EFF(1),e.k0s(),e.j41(2,"form",1),e.bIt("ngSubmit",function(){return n.save()}),e.nI1(3,"async"),e.j41(4,"div",2),e.nI1(5,"async"),e.nrm(6,"df-profile-details",3),e.j41(7,"div",4)(8,"mat-slide-toggle",5),e.EFF(9),e.nI1(10,"transloco"),e.k0s(),e.DNE(11,k,12,15,"ng-container",6),e.DNE(12,N,5,6,"ng-template",null,7,e.C5r),e.DNE(14,K,14,9,"ng-container",8),e.DNE(15,J,16,15,"ng-container",8),e.k0s()(),e.DNE(16,H,1,2,"df-user-app-roles",9),e.nrm(17,"df-lookup-keys",10),e.j41(18,"div",11)(19,"button",12),e.EFF(20),e.nI1(21,"transloco"),e.k0s(),e.j41(22,"button",13),e.EFF(23),e.nI1(24,"transloco"),e.k0s()()()),2&t){const a=e.sdS(13);let l;e.Y8G("showAlert",n.showAlert)("alertType",n.alertType),e.R7$(1),e.SpI(" ",n.alertMsg,"\n"),e.R7$(1),e.HbH(e.bMT(3,17,n.isDarkMode)?"dark-theme":""),e.Y8G("formGroup",n.userForm),e.R7$(2),e.AVh("small",e.bMT(5,19,n.isSmallScreen)),e.R7$(5),e.JRh(e.bMT(10,21,"active")),e.R7$(2),e.Y8G("ngIf","create"===n.type)("ngIfElse",a),e.R7$(3),e.Y8G("ngIf","password"===(null==(l=n.userForm.get("pass-invite"))?null:l.value)||(null==(l=n.userForm.get("setPassword"))?null:l.value)),e.R7$(1),e.Y8G("ngIf",n.accessByTabs.length>0&&"admins"===n.userType&&("create"===n.type||"edit"===n.type&&!n.currentProfile.isRootAdmin)),e.R7$(1),e.Y8G("ngIf","users"===n.userType),e.R7$(3),e.Y8G("routerLink",n.cancelRoute),e.R7$(1),e.SpI(" ",e.bMT(21,23,"cancel")," "),e.R7$(3),e.SpI(" ",e.bMT(24,25,"create"===n.type?"create":"update")," ")}},dependencies:[y.W,i.X1,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,i.$R,i.v8,F.D,v.mV,v.sG,d.bT,m.Wk,m.VT,m._g,T.Hl,T.$z,I.dX,I.aY,M.g7,M.So,_.RG,_.rl,_.nJ,_.TL,D.fS,D.fg,d.pM,O.N,C.S,c.Wk,d.Jj,h.Kj],styles:[".user-details[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:32px}.user-details.small[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.user-details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1}.user-details[_ngcontent-%COMP%]   .additional-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.user-details[_ngcontent-%COMP%]   .additional-info[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.user-details[_ngcontent-%COMP%]   .access-tabs[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;max-height:240px}"]})}};p=(0,R.Cg)([(0,$.d)({checkProperties:!0})],p)}}]);